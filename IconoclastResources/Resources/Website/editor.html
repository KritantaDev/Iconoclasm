<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Iconoclast Layout Editor</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- for ios 7 style, multi-resolution icon of 152x152 -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-barstyle" content="black-translucent">
    <link rel="apple-touch-icon" href="assets/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="Flatkit">
    <!-- for Chrome on Android, multi-resolution icon of 196x196 -->
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="shortcut icon" sizes="196x196" href="assets/images/logo.png">

    <!-- style -->
    <link rel="stylesheet" href="assets/animate.css/animate.min.css" type="text/css" />
    <link rel="stylesheet" href="assets/glyphicons/glyphicons.css" type="text/css" />
    <link rel="stylesheet" href="assets/font-awesome/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="assets/material-design-icons/material-design-icons.css" type="text/css" />

    <link rel="stylesheet" href="assets/bootstrap/dist/css/bootstrap.min.css" type="text/css" />
    <!-- build:css ../assets/styles/app.min.css -->
    <link rel="stylesheet" href="assets/styles/app.css" type="text/css" />
    <!-- endbuild -->
    <link rel="stylesheet" href="assets/styles/font.css" type="text/css" />
</head>
<body class="black">
<div class="black app" id="app">

    <!-- ############ LAYOU
    <!-- content -->
    <div id="content" class="app-content box-shadow-z3" role="main">
        <div class="app-header white box-shadow">
            <div class="navbar navbar-toggleable-sm flex-row align-items-center">
                <!-- Open side - Naviation on mobile -->
                <a data-toggle="modal" data-target="#aside" class="hidden-lg-up mr-3">
                    <i class="material-icons">&#xe5d2;</i>
                </a>
                <!-- / -->
                <!-- navbar collapse -->
                <div class="collapse navbar-collapse" id="collapsee">
                    <!-- link and dropdown -->
                    <ul class="nav navbar-nav mr-auto">
                        <li class="nav-item dropdown">
                            <a>
                                <span id="nameOfLayout"></span>
                            </a>
                        </li>
                    </ul>
                </div>
                <!-- Page title - Bind to $state's title -->
                <div class="mb-0 h5 no-wrap" id="currenticon"></div>

                <!-- navbar collapse -->
                <div class="collapse navbar-collapse" id="collapse">
                    <!-- link and dropdown -->


                    <!-- / -->

                </div>
                <!-- / navbar collapse -->
                <!-- navbar right -->
                <!-- / navbar right -->
            </div>
        </div>
        <img id="devicebackground" src="DeviceBackground.png" style="height: 411px;
        position: absolute;
        margin-left: 49px;
        width: auto;
        border-radius: 15px;
        margin-top: 165px;"/>
        <div class="app-footer">
            <div class="p-2 text-xs">
                <div class="pull-right text-muted py-1">
                    &copy;Copyright <strong>ApexTweaks</strong> 2020 <span class="hidden-xs-down">- Iconoclasm Config UI V1.0.0</span>
                    <a ui-scroll-to="content"><i class="fa fa-long-arrow-up p-x-sm"></i></a>
                </div>
                <div class="nav">
                    <a class="nav-link" href="https://twitter.com/_kritanta">Web configurator by _kritanta. Follow me on twitter!</a>
                </div>
            </div>
        </div>
        <div id="devicepreview" style='background-image: url("Devices/iPhone10,3.png");height: 450px;
    margin-top: 146px;
    position: absolute;
    width: 227px;
    margin-left: 30px;
    background-size: 227px;'>
        </div>


        <div class="app-footer">
            <div class="p-2 text-xs">
                <div class="pull-right text-muted py-1">
                    &copy;Copyright <strong>ApexTweaks</strong> 2020 <span class="hidden-xs-down">- Iconoclasm Config UI V1.0.0</span>
                    <a ui-scroll-to="content"><i class="fa fa-long-arrow-up p-x-sm"></i></a>
                </div>
                <div class="nav">
                    <a class="nav-link" href="https://twitter.com/_kritanta">Web configurator by _kritanta. Follow me on twitter!</a>
                </div>
            </div>
        </div>
        <style>body.black.pace-done {
            overflow-x: hidden;
            overflow-y: hidden;
        }
            div#controlpane {
                margin-left: 300px;
                padding-top: 100px;
                padding-bottom: 47%;
            }div.button {
                 padding: 5px 10px;
                 background-color: #00000059;
                 max-width: 100px;
                 border-radius: 5px;
                 margin-top: 10px;
                 text-align: center;
             }
            .icon{
                opacity: 0.5;
            }
            #currenticon {
                opacity: 0.9;
            }
        </style>
        <div ui-view class="app-body" id="view">

            <!-- ############ PAGE START-->
            <div class="dker">

                <div id="controlpane">
                    <div class="button" id="addbutton">+ Icon</div>
                    <div class="button" id="rembutton">- Icon</div>
                    <div style="margin-top:20px">
                        <a>X: </a> <input type="range" min="-25" max="500" value="0" class="slider" id="xloc">   <a id="xlabel">0</a>
                    </div>
                    <div style="margin-top:20px">
                        <a>Y: </a> <input type="range" min="-45" max="1000" value="0" class="slider" id="yloc">  <a id="ylabel">0</a>
                    </div>

                    <div class="button" id="sendbutton" onclick="submit();" style="margin-top:100px">Add to Device</div>

                </div>
            </div>
            <div class="row no-gutter">

            </div>
            <div class="row no-gutter">

            </div>

            <!-- ############ PAGE END-->

        </div>
    </div>
    <!-- / -->

    <!-- ############ LAYOUT END-->

</div>
<script>
    var xslider = document.getElementById("xloc")
    var xlabel = document.getElementById("xlabel")
    xslider.oninput = function() {
        xlabel.innerHTML = this.value-25;
        document.getElementById("currenticon").style.marginLeft = this.value + "px";
    }

    var yslider = document.getElementById("yloc")
    var ylabel = document.getElementById("ylabel")
    yslider.oninput = function() {
        ylabel.innerHTML = this.value-45;
        document.getElementById("currenticon").style.marginTop = this.value + "px";
    }

    let iconAddButton = document.getElementById("addbutton");
    iconAddButton.onclick = function () {
        let x = document.getElementById("currenticon");
        x.classList.add("icon");
        document.getElementById("currenticon").id = "icon"+(document.getElementById("devicepreview").childNodes.length-1);

        let ncurrentIconObject = document.createElement("div");
        ncurrentIconObject.id = "currenticon";
        ncurrentIconObject.style.width = '30px';
        ncurrentIconObject.style.position = 'absolute';
        ncurrentIconObject.style.height = '30px';
        ncurrentIconObject.style.textAlign = 'center';
        ncurrentIconObject.innerHTML = "<a>" + (document.getElementById("devicepreview").childNodes.length-1) + "</a>";
        ncurrentIconObject.style.backgroundColor = 'grey';
        ncurrentIconObject.style.borderRadius = '10px';
        ncurrentIconObject.style.marginLeft = '25px';
        ncurrentIconObject.style.marginTop = '45px';
        ncurrentIconObject.ondblclick = function () {
            this.remove();
            document.getElementById("icon"+(document.getElementById("devicepreview").childNodes.length-1)).id = "currenticon";
        };
        document.getElementById("xloc").value = 0;
        document.getElementById("xlabel").innerHTML = 0;
        document.getElementById("yloc").value = 0;
        document.getElementById("ylabel").innerHTML = 0;
        document.getElementById("devicepreview").appendChild(ncurrentIconObject);
        let shit = [];
        var icons = document.querySelectorAll(".icon");
        console.log(icons);
        for (var i = 0, len = icons.length; i < len; i++)
        {
            var icon = icons[i];
            let thing = {
                "x": parseInt(icon.style.marginLeft)*(1.9),
                "y": parseInt(icon.style.marginTop)*(1.9)
            };
            console.log("thing:" + thing);
            shit.push(thing);

        }
        console.log(icons.length);
        console.log(shit);
    }
    function submit() {
        let shit = [];
        var icons = Array.apply(null, document.querySelectorAll(".icon"));
        icons.shift();
        icons.push(document.getElementById("currenticon"));
        console.log(icons);
        for (var i = 0, len = icons.length; i < len; i++)
        {
            var icon = icons[i];
            let thing = {
                "x": parseInt(icon.style.marginLeft)*(1.9),
                "y": parseInt(icon.style.marginTop)*(1.9)
            };
            console.log("thing:" + thing);
            shit.push(thing);

        }
        console.log(shit);
        var json_upload = urlParams.get('name') + "=" + JSON.stringify(shit);
        var xmlhttp = new XMLHttpRequest();   // new HttpRequest instance
        xmlhttp.open("POST", "/layout");
        xmlhttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
        xmlhttp.send(json_upload);
        xmlhttp.send(more);
    }
</script>
<!-- build:js scripts/app.html.js -->
<!-- jQuery -->
<script src="libs/jquery/jquery/dist/jquery.js"></script>
<!-- Bootstrap -->
<script src="libs/jquery/tether/dist/js/tether.min.js"></script>
<script src="libs/jquery/bootstrap/dist/js/bootstrap.js"></script>
<!-- core -->
<script src="libs/jquery/underscore/underscore-min.js"></script>
<script src="libs/jquery/jQuery-Storage-API/jquery.storageapi.min.js"></script>
<script src="libs/jquery/PACE/pace.min.js"></script>

<script src="html/scripts/config.lazyload.js"></script>

<script src="html/scripts/palette.js"></script>
<script src="html/scripts/ui-load.js"></script>
<script src="html/scripts/ui-jp.js"></script>
<script src="html/scripts/ui-include.js"></script>
<script src="html/scripts/ui-device.js"></script>
<script src="html/scripts/ui-form.js"></script>
<script src="html/scripts/ui-nav.js"></script>
<script src="html/scripts/ui-screenfull.js"></script>
<script src="html/scripts/ui-scroll-to.js"></script>
<script src="html/scripts/ui-toggle-class.js"></script>

<script src="html/scripts/app.js"></script>

<!-- ajax -->
<script src="libs/jquery/jquery-pjax/jquery.pjax.js"></script>
<script src="html/scripts/ajax.js"></script>
<!-- endbuild -->
<script>
    var urlParams = new URLSearchParams(window.location.search);
    if (!urlParams.has('name')) window.location.href = "/";
    document.getElementById("nameOfLayout").innerText = urlParams.get('name');
    document.getElementById("devicepreview").style.backgroundImage = 'url("Devices/' + urlParams.get('code') + '.png")';
</script>
</body>
</html>
